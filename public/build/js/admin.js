function iniciarApp(){AddProducto(),ActualizarProducto(),verificarLogin(),editarTabla(),ObtenerProductoPorId(),ActualizarProductoModal(),EstadoModal(),ActualizarColaboradorModal(),ActualizarColaborador(),ActualizarCategoriaModal(),ActualizarCategoria(),AddCategoria(),ActualizarMarcaModal(),AddMarca(),ActualizarMarca(),AddColaborador(),UpdateStado(),getUsuario()}function verificarLogin(){$("#login").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();$.ajax({type:$(this).attr("method"),data:o,url:"/login",dataType:"json",success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Login Exitoso","Bienvenido "+o.usuario,"success"),setTimeout((function(){window.location.href="/admin"}),600)),"error"==o.resultado&&swal.fire("Error","Password Incorrecto o Usuario No existente","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function editarTabla(){$("#registro").DataTable({dom:"Bfrti",buttons:{dom:{button:{className:"btn"}},buttons:[{extend:"excel",text:"Generar Excel",className:"btn btn-outline-success ",excelStyles:{template:"blue_medium"}}]},paging:!0,lengthChange:!0,searching:!0,ordering:!1,info:!0,autoWidth:!1,pageLength:1e3,language:{info:"Mostrando del _START_ al _END_ de _TOTAL_ resultados",emptyaTable:"No hay registros",infoEmpty:"0 Registros",search:"Buscar",zeroRecords:"No se encontraron resultados",emptyTable:"Ningún dato disponible en esta tabla",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primero",last:"Último",next:"Siguiente",previous:"Anterior"}}})}function ObtenerProductoPorId(){$(".btnModal").on("click",(function(){var r=$(this).data("id");$.ajax({method:"POST",url:"/getInfo",data:{ventaId:r},success:function(r){var o=r;const e=JSON.parse(o);$(".del").remove();var a=$("#MyModaltable_header").find(".table tbody");e.ventas.forEach((function(r){a.append('<tr class="del"><td class="text-center">'+r.nombres+'</td><td class="text-center">'+r.apellidos+'</td><td class="text-center">'+r.telefono+'</td><td class="text-center">S/. '+r.total+"</td></tr>")}));var t=$("#MyModaltable").find(".table tbody");e.detalle.forEach((function(r){console.log(r.ventaId),t.append('<tr class="del"><td class="text-center">'+r.nombre+'</td><td class="text-center">'+r.categoria+'</td><td class="text-center">'+r.cantidad+'</td><td class="text-center">S/. '+r.precio+'</td><td class="text-center">S/. '+r.total+"</td></tr>")}))}})}))}function ActualizarProducto(){$("#editarProducto").on("submit",(function(r){r.preventDefault();var o=new FormData(this);$.ajax({type:"POST",data:o,url:"/editarProducto",dataType:"json",contentType:!1,processData:!1,async:!0,cache:!1,success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Exito","Actualizado correctamente ","success"),setTimeout((function(){window.location.href="/viewProducto"}),600)),"error"==o.resultado&&swal.fire("Error","Error al Actualizar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function AddProducto(){$("#addProducto").on("submit",(function(r){r.preventDefault();var o=new FormData(this);console.log(o),$.ajax({type:"POST",data:o,url:"/addProducto",dataType:"json",contentType:!1,processData:!1,async:!0,cache:!1,success:function(r){console.log(r);var o=r;if("exito"==o.resultado){Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:900}).fire({icon:"success",title:"Registrado Corectamente"}),setTimeout((function(){window.location.href="/viewProducto"}),900)}"error"==o.resultado&&swal.fire("Error","Error al agregar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function ActualizarProductoModal(){$(".editbtn").on("click",(function(r){$tr=$(this).closest("tr");var o=$tr.children("td").map((function(){return $(this).text()}));$cat=$(this).data("idcategoria"),$("#id").val(o[0]),$("#nombre").val(o[1]),$("#precio").val(o[2]),$("#idcategoria").text(o[3]),$("#idcategoria").val($cat),$("#stock").val(o[5])}))}function ActualizarCategoriaModal(){$(".editbtnCategoria").on("click",(function(r){$tr=$(this).closest("tr");var o=$tr.children("td").map((function(){return $(this).text()}));$("#id").val(o[0]),$("#nombre").val(o[1]),$("#descripcion").val(o[2])}))}function ActualizarCategoria(){$("#editarCategoria").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();$.ajax({type:"POST",data:o,url:"/addEditarCategoria",dataType:"json",success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Exito","Actualizado correctamente ","success"),setTimeout((function(){window.location.href="/viewCategorias"}),600)),"error"==o.resultado&&swal.fire("Error","Error al Actualizar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function AddCategoria(){$("#addcategoria").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();console.log(o),$.ajax({type:"POST",data:o,url:"/addEditarCategoria",dataType:"json",success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Registro Exitoso","","success"),setTimeout((function(){window.location.href="/viewCategorias"}),900)),"alerta"==o.resultado&&swal.fire("Advertencia!!!","Ya existe un usuario con ese correo","warning"),"error"==o.resultado&&swal.fire("Error","Error al agregar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function ActualizarColaborador(){$("#editarColaborador").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();$.ajax({type:"POST",data:o,url:"/addEditarColaborador",dataType:"json",success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Exito","Actualizado correctamente ","success"),setTimeout((function(){window.location.href="/viewColaborador"}),600)),"error"==o.resultado&&swal.fire("Error","Error al Actualizar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function ActualizarMarcaModal(){$(".editbtnMarca").on("click",(function(r){$tr=$(this).closest("tr");var o=$tr.children("td").map((function(){return $(this).text()}));$("#id").val(o[0]),$("#nombre").val(o[1]),$("#descripcion").val(o[2])}))}function ActualizarMarca(){$("#editarMarca").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();$.ajax({type:"POST",data:o,url:"/addEditarMarca",dataType:"json",success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Exito","Actualizado correctamente ","success"),setTimeout((function(){window.location.href="/viewMarcas"}),600)),"error"==o.resultado&&swal.fire("Error","Error al Actualizar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function AddMarca(){$("#addMarca").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();console.log(o),$.ajax({type:"POST",data:o,url:"/addEditarMarca",dataType:"json",success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Registro Exitoso","","success"),setTimeout((function(){window.location.href="/viewMarcas"}),900)),"alerta"==o.resultado&&swal.fire("Advertencia!!!","No se puede registrar","warning"),"error"==o.resultado&&swal.fire("Error","Error al agregar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function AddColaborador(){$("#addColaborador").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();console.log(o),$.ajax({type:"POST",data:o,url:"/crear-usuario",dataType:"json",success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Registro Exitoso","Bienvenido","success"),setTimeout((function(){window.location.href="/viewColaborador"}),900)),"alerta"==o.resultado&&swal.fire("Advertencia!!!","Ya existe un usuario con ese correo","warning"),"error"==o.resultado&&swal.fire("Error","Error al agregar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function ActualizarColaboradorModal(){$(".editColaboradorbtn").on("click",(function(r){$tr=$(this).closest("tr");var o=$tr.children("td").map((function(){return $(this).text()}));console.log(o),$("#id").val(o[0]),$("#nombre").val(o[1]),$("#apellido").val(o[2]),$("#email").val(o[3]),$("#telefono").val(o[4])}))}function nuevoMostrarDatosUserModal(){$(".editColaboradorbtn").on("click",(function(r){r.preventDefault(),$tr=$(this).closest("tr");var o=$tr.children("td").map((function(){return $(this).text()}));$email=o[3],console.log($email),$.ajax({type:"POST",data:$email,url:"/getInfoUser",dataType:"json",success:function(r){console.log(r)},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function getUsuario(){$("#editarCuenta").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();console.log(o),$.ajax({type:"POST",data:o,url:"/cuenta",dataType:"json",success:function(r){console.log(r);var o=r;"exito"==o.resultado&&(swal.fire("Registro Exitoso","Actualizado Correctamente","success"),setTimeout((function(){window.location.href="/viewProducto"}),900)),"alerta"==o.resultado&&swal.fire("Error!!!","La contraseña actual no es correcta","warning"),"error"==o.resultado&&swal.fire("Error","Error al agregar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function report(){$("#report").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();console.log(o),$.ajax({type:"POST",data:o,url:"/report",dataType:"json",success:function(r){console.log(r)},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function EstadoModal(){$(".btnModalEstado").on("click",(function(r){$id=$(this).data("id"),console.log($id),$("#id").val($id)}))}function UpdateStado(){$("#updateEstado").on("submit",(function(r){r.preventDefault();var o=$(this).serializeArray();console.log(o),$.ajax({type:"POST",data:o,url:"/updateEstado",dataType:"json",success:function(r){console.log(r);var o=r;if("exito"==o.resultado){Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:900}).fire({icon:"success",title:"Estado actualizado"}),setTimeout((function(){window.location.href="/admin"}),900)}"alerta"==o.resultado&&swal.fire("Advertencia!!!","Ya existe un usuario con ese correo","warning"),"error"==o.resultado&&swal.fire("Error","Error al agregar","error")},error:function(r){swal.fire("UPS!!!","Lo sentimos hubo un error inesperado","error")}})}))}function ValidateInput(r){for(i in r)""==r[i].value?$("#nombre").addClass("is-invalid"):console.log("nombre lleno")}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));