!function(){var a="jstarbox-data",t={average:.5,stars:5,buttons:5,ghosting:!1,changeable:!0,autoUpdateAverage:!1},e={destroy:function(){this.removeData(a),this.unbind(".jstarbox").find("*").unbind(".jstarbox"),this.removeClass("starbox"),this.empty()},getValue:function(){return this.data(a).opts.currentValue},setValue:function(t){var e=this.data(a),s=arguments[1]||e.positioner.width(),r=arguments[2];r&&e.ghost.css({width:t*s+"px"}),e.colorbar.css({width:t*s+"px"}),e.opts.currentValue=t},getOption:function(t){return this.data(a).opts[t]},setOption:function(t,e){var s=this.data(a);"changeable"===t&&!1===e&&s.positioner.triggerHandler("mouseleave"),s.opts[t]=e,"stars"===t?s.methods.update_stars():"average"===t&&this.starbox("setValue",e,null,!0)},markAsRated:function(){this.data(a).positioner.addClass("rated")}};jQuery.fn.extend({starbox:function(s){return s.constructor===String&&e[s]?e[s].apply(this,Array.prototype.slice.call(arguments,1))||this:(s=jQuery.extend({},t,s),this.each((function(t){var r=jQuery(this),o=jQuery.extend({},s),n={opts:o,methods:{}};r.data(a,n);var i=n.positioner=jQuery("<div/>").addClass("positioner"),d=n.stars=jQuery("<div/>").addClass("stars").appendTo(i),l=n.ghost=jQuery("<div/>").addClass("ghost").hide().appendTo(d),u=(n.colorbar=jQuery("<div/>").addClass("colorbar").appendTo(d),n.star_holder=jQuery("<div/>").addClass("star_holder").appendTo(d));r.empty().addClass("starbox").append(i),n.methods.update_stars=function(){u.empty();for(var a=0;a<o.stars;a++)jQuery("<div/>").addClass("star").addClass("star-"+a).appendTo(u);e.setOption.call(r,"average",o.average)},n.methods.update_stars(),i.bind("mousemove.jstarbox",(function(a){if(o.changeable){o.ghosting&&l.show();var t=i.width(),s=a.layerX;void 0===s&&(s=a.pageX-i.offset().left);var n=s/t;o.buttons&&(n*=o.buttons,n=Math.floor(n),n+=1,n/=o.buttons),i.addClass("hover"),e.setValue.call(r,n,t),r.starbox("setValue",n,t),r.triggerHandler("starbox-value-moved",n)}})),i.bind("mouseleave.jstarbox",(function(a){o.changeable&&(l.hide(),i.removeClass("hover"),e.setValue.call(r,o.average))})),i.bind("click.jstarbox",(function(a){if(o.changeable){o.autoUpdateAverage&&(e.markAsRated.call(r),e.setOption.call(r,"average",o.currentValue));var t=r.triggerHandler("starbox-value-changed",o.currentValue);!isNaN(parseFloat(t))&&isFinite(t)&&e.setOption.call(r,"average",t),"once"===o.changeable&&e.setOption.call(r,"changeable",!1)}}))})),this)}})}();